<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Alfred</title>

    <!-- Bulma.io CSS Framework -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.0.26/css/bulma.min.css">

    <!-- Font awesome CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='font-awesome/css/font-awesome.min.css') }}">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"
            integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>

    <!-- Custom CSS -->
    <link rel=stylesheet type=text/css href="{{ url_for('static', filename='style.css') }}">

</head>

<body>
<div class="container is-fluid">

    <!-- Invisible audio player -->
    {% if wavfile %}
        <audio autoplay src="data:audio/wav;base64,{{ wavfile }}">Your browser does not support this audio format.
        </audio>
    {% endif %}


    <!-- Header -->
    {% include 'header.html' %}

    <div class="container">

        <!-- Flashed messages -->

        {% with messages = get_flashed_messages(category_filter=['success']) %}
            {% if messages %}
                <div class="columns">
                    <div class="column has-text-centered">
                        {% for message in messages %}
                            <article class="message is-success">
                                <div class="message-body"> {{ message }}</div>
                            </article>
                        {% endfor %}
                    </div>
                </div>
            {% endif %}
        {% endwith %}

        <!-- Invalid login error message -->
        {% if form.errors %}
            <article class="message is-danger">
                <div class="message-body has-text-centered">
                    Invalid username/password. Please try again.
                    <!--
                    {% for field_name, field_errors in form.errors|dictsort if field_errors %}
                        {% for error in field_errors %}
                            {{ form[field_name].label }} {{ error }}
                        {% endfor %}
                    {% endfor %}
                    -->
                </div>
            </article>
        {% endif %}

        <!-- Fullscreen Content -->
        {% block fullscreen %}

            <!-- Column Section-->
            <div class="columns">

                <!-- Left 1/4 of screen -->
                <div class="column is-one-quarter">

                    <h3 class="title is-3">Recipes</h3>
                    {% for recipe in recipe_suggestions %}
                        <p><a href="/search?recipe_name={{ recipe.title|urlencode }}">{{ recipe.title }}</a></p>
                    {% endfor %}

                </div>

                <!-- Right 3/4 of screen -->
                <div class="column is-three-quarters">

                    <div class="recipe_list">
                        {% block content %}
                        {% endblock %}
                    </div>

                </div>

            </div>

        {% endblock %}

    </div>

</div>

<!-- Microphone recorder functions -->
<div class="tooltip">
    <a>
        <img src="{{ url_for('static', filename='images/alfred2.png') }}" class="microphone" onclick="startRecording()">
    </a>
    <span class="tooltiptext">Click Alfred to start speaking<br>Click again to when finished speaking</span>
</div>

<script src="{{ url_for('static', filename='js/recorder.js') }}"></script>

<!-- Javascript functions -->
<script src="{{ url_for('static', filename='js/js-functions.js') }}"></script>

<!-- Login modal -->
{% include "login.html" %}

</body>
</html>
